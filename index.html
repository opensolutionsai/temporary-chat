<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SilentTalk-Friday Chat</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üëª</text></svg>">
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">


    
</head>

<body>
    <div id="app">
        <!-- Landing View -->
        <div class="view active" id="view-landing">
            <header>
                <h1>SilentTalk-Friday Chat</h1>
                <p>Secure, Temporary, Encrypted.</p>
            </header>

            <div class="container">
                <!-- TABS -->
                <div class="tabs">
                    <button class="tab-btn active" data-tab="create">Create Room</button>
                    <button class="tab-btn" data-tab="join">Join Room</button>
                </div>

                <!-- CREATE FORM -->
                <form id="create-form" class="tab-content active" onsubmit="return false;">
                    <input type="text" id="create-nickname" placeholder="Your Nickname" maxlength="20">
                    <input type="password" id="create-password" placeholder="Set Room Password" autocomplete="off">

                    <div class="form-group">
                        <label>Duration:</label>
                        <select id="room-timer">
                            <option value="5">5 Minutes</option>
                            <option value="60">1 Hour</option>
                            <option value="1440">24 Hours</option>
                        </select>
                    </div>

                    <div class="checkbox-group">
                        <input type="checkbox" id="create-agree" required>
                        <label for="create-agree">I agree to the <a href="#" class="policy-link">Terms & Privacy
                                Policy</a></label>
                    </div>

                    <div class="actions">
                        <button type="button" id="btn-create" class="primary-btn">Create Private Room</button>
                    </div>
                </form>

                <!-- JOIN FORM -->
                <form id="join-form" class="tab-content" onsubmit="return false;">
                    <input type="text" id="join-room-id" placeholder="Room Code (e.g. 1234)" maxlength="4"
                        pattern="\d{4}" style="text-align:center; letter-spacing: 2px;">
                    <input type="password" id="join-password" placeholder="Room Password (if not in link)"
                        autocomplete="off">
                    <input type="text" id="join-nickname" placeholder="Your Nickname" maxlength="20">

                    <div class="checkbox-group">
                        <input type="checkbox" id="join-agree" required>
                        <label for="join-agree">I agree to the <a href="#" class="policy-link">Terms & Privacy
                                Policy</a></label>
                    </div>

                    <div class="actions">
                        <button type="button" id="btn-join" class="secondary-btn">Join Chat</button>
                    </div>
                </form>
            </div>

            <footer>
                <a href="#" class="policy-link">Terms, Privacy & Warnings</a>
                <p style="margin-top:5px; font-size: 0.7rem; opacity: 0.5;">v1.0.0 ‚Ä¢ E2E Encrypted</p>
            </footer>
        </div>

        <!-- Room View -->
        <main id="room-view" class="view hidden">
            <header class="chat-header">
                <div class="room-info">
                    <span id="room-status">‚óè Live</span>
                    <div style="display:flex; align-items:baseline; gap:10px;">
                        <span id="room-code-display"
                            style="font-size: 1.5rem; font-weight: 800; color: white;">#----</span>
                        <div style="font-size: 0.9rem; opacity: 0.7;">‚è± <span id="room-timer-display">00:00</span></div>
                    </div>
                </div>
                <div class="room-controls">
                    <button id="btn-self-destruct" title="Destroy Room" class="hidden danger-btn"
                        style="margin-right: 10px;">üí• Nuke</button>
                    <button id="btn-participants" title="View Participants">üë• <span id="user-count">0</span></button>
                    <button id="btn-copy-link" title="Copy Link (Pw Required)">üîó</button>
                    <button id="btn-copy-link-pass" title="Copy Link + Password"
                        style="background: var(--accent-color); border:none; margin-left:5px;">üîëüîó</button>
                    <button id="btn-leave" title="Leave" class="danger-btn">Exit</button>
                </div>
            </header>

            <!-- User List Panel -->
            <div id="user-list-panel" class="hidden">
                <h3>Participants</h3>
                <ul id="user-list">
                    <!-- Users injected here -->
                </ul>
            </div>

            <div id="chat-container">
                <div class="message system">
                    <p>üîí This chat is end-to-end encrypted and will self-destruct.</p>
                </div>
                <!-- Messages will be injected here -->
            </div>

            <footer class="chat-input-area">
                <div id="typing-indicator" class="hidden">Someone is typing...</div>
                <div class="input-wrapper">
                    <input type="text" id="message-input" placeholder="Type a message..." autocomplete="off">
                    <button id="btn-send">‚û§</button>
                </div>
            </footer>
        </main>
    </div>

    <!-- Screenshot Warning Overlay -->
    <div id="security-overlay" class="hidden">
        <div class="warning-box">
            <h3>‚ö†Ô∏è Privacy Warning</h3>
            <p>Screenshots are discouraged to protect privacy.</p>
            <button id="btn-dismiss-warning">Understood</button>
        </div>
    </div>

    <!-- LEGAL MODAL -->
    <div id="policy-modal" class="hidden overlay">
        <div class="modal-content legal-doc">
            <h2>Terms, Privacy & Warnings</h2>
            <div class="scroll-area">
                <h3>1. Terms of Service</h3>
                <p><strong>Acceptable Use:</strong> You agree not to use SilentTalk-Friday Chat for any illegal purposes,
                    harassment, hate speech, or the distribution of prohibited content. You must be at least 13 years
                    old to use this service.</p>
                <p><strong>Room Administration:</strong> Room creators act as independent administrators. They have the
                    absolute right to "kick" participants or "nuke" (destroy) the room at any time. We are not
                    responsible for the actions of room creators.</p>
                <p><strong>No Liability:</strong> This service is provided "AS IS" without warranty of any kind. We are
                    not liable for any data loss, damages, or consequences resulting from your use of this platform.</p>

                <h3>2. Privacy Policy</h3>
                <p><strong>End-to-End Encryption:</strong> Message content is encrypted on your device using your room
                    password before it reaches our servers. We do not possess the decryption keys and cannot read your
                    messages.</p>
                <p><strong>Data Retention:</strong> All room data (messages and participant lists) is permanently
                    deleted from our database when the room expires or is destroyed by the host.</p>
                <p><strong>Functional Storage:</strong> We do not use cookies for advertising. We use your browser's
                    Local Storage strictly for functional purposes (e.g., to remember if you have been banned from a
                    specific room).</p>
                <p><strong>Connection Metadata:</strong> While we cannot read your chats, standard internet connection
                    data (such as IP addresses) is processed by our service providers to facilitate real-time
                    communication.</p>

                <h3>3. Security & Disclaimers</h3>
                <p><strong>Unmoderated Content:</strong> Because the chat is encrypted, we cannot view or moderate
                    content. Users engage in private rooms at their own risk.</p>
                <p><strong>Screenshots:</strong> Code cannot prevent physical screenshots or external recording. Only
                    chat with people you trust.</p>
                <p><strong>Link Security:</strong> If you share a link with the <code>?pass=</code> parameter (the
                    "Secret Link"), anyone who clicks it can join your room immediately. Treat these links like
                    passwords.</p>
            </div>
            <button id="btn-close-policy" class="primary-btn">Close</button>
        </div>
    </div>

    <script src="app.js"></script>
</body>


</html>


